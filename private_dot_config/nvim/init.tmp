-- General Settings
vim.opt.showmatch = true -- show matching brackets
vim.opt.ignorecase = true -- case insensitive searching
vim.opt.smartcase = true -- capital letters trigger case-sensitive search
vim.opt.incsearch = true -- incremental search
vim.opt.tabstop = 4 -- number of columns occupied by a tab
vim.opt.softtabstop = 4 -- see multiple spaces as tabstops
vim.opt.expandtab = true -- converts tabs to white space
vim.opt.smarttab = true -- smart tabbing
vim.opt.shiftwidth = 4 -- width for autoindents
vim.opt.smartindent = true -- smart indenting
vim.opt.autoindent = true -- auto indenting
vim.opt.relativenumber = true -- relative line numbers
vim.opt.number = true -- show current line number
vim.opt.hlsearch = false -- disable search highlighting
vim.opt.hidden = true -- allow hidden buffers
vim.opt.wrap = false -- no line wrapping
vim.opt.swapfile = false -- no swap files
vim.opt.undodir = vim.fn.expand("~/.local/share/nvim/undodir/") -- undo directory
vim.opt.undofile = true -- persistent undo
vim.opt.scrolloff = 8 -- minimal lines to keep above/below cursor
vim.opt.encoding = "UTF-8" -- file encoding
vim.opt.wildmode = "longest,list,full"
vim.opt.wildmenu = true -- command line completion
vim.opt.cursorline = true -- highlight current line
vim.opt.title = true -- window title
vim.opt.mouse = "a" -- enable mouse support
vim.opt.lazyredraw = true -- faster macros
vim.opt.showmode = false -- don't show mode in command line
vim.opt.splitbelow = true -- horizontal splits go below
vim.opt.splitright = true -- vertical splits go right
vim.opt.backup = false -- no backup files
vim.opt.writebackup = false -- no backup files
vim.opt.signcolumn = "yes" -- always show sign column
vim.opt.updatetime = 100 -- faster completion
vim.opt.termguicolors = true -- true color support
vim.opt.background = "dark" -- dark background

-- File finding settings
vim.opt.path:append("**")
vim.opt.wildignore:append("*/node_modules/*")
vim.opt.wildignore:append("**/.git/*")

-- Leaders
vim.g.mapleader = " "
vim.g.maplocalleader = ","

-- Load key mappings
vim.cmd("runtime ./maps.vim")

-- Setup lazy.nvim
local lazypath = vim.fn.stdpath("data") .. "/lazy/lazy.nvim"
if not vim.loop.fs_stat(lazypath) then
	vim.fn.system({
		"git",
		"clone",
		"--filter=blob:none",
		"https://github.com/folke/lazy.nvim.git",
		"--branch=stable", -- latest stable release
		lazypath,
	})
end
vim.opt.rtp:prepend(lazypath)

require("lazy").setup("plugins")

-- Gruvbox Theme Setup
require("gruvbox").setup({
	terminal_colors = true,
	undercurl = true,
	underline = true,
	bold = true,
	italic = {
		strings = false,
		emphasis = true,
		comments = true,
		operators = false,
		folds = true,
	},
	strikethrough = true,
	invert_selection = false,
	invert_signs = false,
	invert_tabline = false,
	invert_intend_guides = false,
	inverse = true,
	contrast = "hard",
	palette_overrides = {},
	overrides = {},
	dim_inactive = false,
	transparent_mode = true,
})

vim.cmd("colorscheme gruvbox")

-- Set colorscheme
vim.o.colorscheme = "gruvbox"

-- TreesitterContext highlighting
vim.cmd("highlight TreesitterContext ctermbg=NONE guibg=#504945")

-- Yank highlighting
vim.api.nvim_create_autocmd("TextYankPost", {
	callback = function()
		vim.highlight.on_yank({ timeout = 40 })
	end,
})

-- Two-space indentation for specific file types
local two_space_files = {
	"javascript",
	"javascriptreact",
	"typescript",
	"typescriptreact",
	"lua",
	"elixir",
	"svelte",
}

vim.api.nvim_create_autocmd("FileType", {
	pattern = two_space_files,
	callback = function()
		vim.opt_local.shiftwidth = 2
		vim.opt_local.tabstop = 2
	end,
})

-- Neorg settings
vim.api.nvim_create_autocmd("FileType", {
	pattern = "norg",
	callback = function()
		vim.opt_local.conceallevel = 2
		vim.opt_local.wrap = true
		vim.opt_local.linebreak = true
		vim.opt_local.spell = true
	end,
})
